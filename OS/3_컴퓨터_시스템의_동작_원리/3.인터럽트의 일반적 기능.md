# 🚓 인터럽트의 일반적 기능

앞서 기술했던 것처럼, 프로그램이 요청한 데이터를 디스크 컨트롤러가 로컬 버퍼로 읽어온 후 인터럽트를 발생시키면 CPU는 인터럽트가 들어옴을 인지하고 인터럽트 관련 없무를 수행한다.

OS는 각종 하드웨어, 소프트웨어 자원 관리 뿐 아니라 사용자 프로그램에 필요한 서비스도 제공한다.

인터럽트에는 하드웨어 인터럽트, 소프트웨어 인터럽트 등 두가지의 종류가 있다. CPU의 서비스가 필요한 경우, CPU 옆에 있는 인터럽트 라인에 신호를 보내서 인터럽트가 발생했음을 알려주는 방식은 동일하다.

다만 하드웨어 인터럽트의 경우 컨트롤러 등 하드웨어 장치가 CPU 인터럽트 라인을 세팅하는 반면, 소프트웨어 인터럽트는 소프트웨어가 그 일을 수행한다는 차이점이 있다.

두 가지 인터럽트 모두 일단 발생하면 CPU는 하던 일을 멈추고 운영체제 커널 내에서 해당 인터럽트의 처리를 위해 정의된 코드를 찾게 된다.

> 이때 운영체제는 할 일을 쉽게 찾아가기 위해 **인터럽트 벡터 (Interrupt vector)** 를 가진다. 인터럽트 벡터란 인터럽트 종류마다 번호를 정해서 번호에 따라 처리해야 할 코드가 위치한 부분을 가리키고 있는 자료구조를 말한다.

이와 달리 실제 처리해야 하는 부분은 인터럽트 처리 루틴 혹은 인터럽트 핸들러라고 불리는 다른 곳에 정의된다.

### 소프트웨어 인터럽트

통상적으로 인터럽트라고 한다면 하드웨어 인터럽트를 의미하고, 소프트웨어 인터럽트는 트랩이라는 용어로 주로 불린다.

소프트웨어 인터럽트의 예로는 다음이 있다.

- 예외 상황 (Exception) : 사용자 프로그램이 0으로 나누는 연산 등 비정상적인 작업을 시도하거나, 자신의 메모리 영역 바깥에 접근하려는 시도 등 권한이 없는 작업을 시도할 때 이에 대한 처리를 위해 발생시키는 인터럽트를 말한다.

- 시스템 콜 (System call) : 사용자 프로그램이 운영체제 내부에 정의된 코드(입출력 연산 등)를 실행하고 싶을 떄 운영체제에 서비스를 요청하는 방법이다.

  > 사용자 프로그램 자신의 코드는 직접 CPU를 가지고 실행하지만, 사용자 프로그램에 정의되지 않고 운영체제 커널에 잇는 코드를 사용자 프로그램이 실행하고자 할 때에는 인터럽트 라인 세팅을 통해 CPU 제어권을 운영체제로 넘겨서 실행하게 되는 것이다.

시스템 콜이나 예외상황은 모두 사용자 프로세스로부터 CPU의 제어권이 운영체제에 이양되어 처리되는데, 이 과정에서 프로그램 코드가 인터럽트 라인을 세팅하는 명령을 실행하여 인터럽트를 발생시킨 후 제어권이 넘어가게 되므로 소프퉤어 인터럽트 또한 넓은 의미에서는 인터럽트의 범주에 포함된다.
